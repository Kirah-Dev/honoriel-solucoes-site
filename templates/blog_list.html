{% extends "base.html" %}

{% block title %}Blog - Honoriel Soluções{% endblock %}

{% block content %}
<section id="blog-list-header" class="text-center"
  style="padding: 60px 20px; background-color: var(--color-light-gray);">
  <div class="container">
    <h1>Nosso Blog</h1>
    <p style="font-size: 1.2rem; max-width: 700px; margin: 0 auto; color: var(--color-medium-gray);">
      Artigos, insights e novidades do mercado de trabalho, preparados por nossos especialistas.
    </p>
  </div>
</section>

<section id="blog-list-main" style="padding: 60px 0;">
  <div class="container blog-list-container">

    {% if pagination.items %}
    <div class="blog-grid-public">
      <!-- O laço começa aqui -->
      {% for post in pagination.items %}
      <article class="blog-card-public">
        <a href="{{ url_for('blog_post', post_id=post.id) }}" class="card-image-link">
          {% if post.imagem_destaque_path %}
          <img src="{{ url_for('view_upload', filename=post.imagem_destaque_path) }}"
            alt="Imagem de destaque para {{ post.titulo }}">
          {% else %}
          <img src="https://via.placeholder.com/400x250.png?text=Honoriel" alt="Imagem padrão">
          {% endif %}
        </a>
        <div class="card-content">
          <p class="post-meta">
            <span class="post-date">{{ post.data_publicacao.strftime('%d de %B de %Y') }}</span>
          </p>
          <h2 class="post-title">
            <a href="{{ url_for('blog_post', post_id=post.id) }}">{{ post.titulo }}</a>
          </h2>
          <p class="post-excerpt">
            {{ post.conteudo | striptags | truncate(150) }}
          </p>
          <a href="{{ url_for('blog_post', post_id=post.id) }}" class="read-more-link">Leia Mais &rarr;</a>
        </div>
      </article>
      <!-- A tag 'article' fecha aqui, dentro do laço, para cada post -->
      {% endfor %}
      <!-- O laço termina aqui -->
    </div>
    {% else %}
    <div class="text-center" style="padding: 50px 0;">
      <h3>Nenhum post encontrado.</h3>
      <p>Volte em breve para conferir nosso conteúdo!</p>
    </div>
    {% endif %}

    <!-- A seção de paginação fica FORA do laço e da div .blog-grid-public -->
    {% if pagination.pages > 1 %}
    <nav aria-label="Navegação das páginas do blog" class="pagination-nav">
      <ul class="pagination">
        <li class="page-item {% if not pagination.has_prev %}disabled{% endif %}">
          <a class="page-link"
            href="{{ url_for('blog_list', page=pagination.prev_num) if pagination.has_prev else '#' }}">&laquo;
            Anterior</a>
        </li>

        {% for page_num in pagination.iter_pages(left_edge=1, right_edge=1, left_current=1, right_current=2) %}
        {% if page_num %}
        {% if pagination.page == page_num %}
        <li class="page-item active"><a class="page-link" href="#">{{ page_num }}</a></li>
        {% else %}
        <li class="page-item"><a class="page-link" href="{{ url_for('blog_list', page=page_num) }}">{{ page_num }}</a>
        </li>
        {% endif %}
        {% else %}
        <li class="page-item disabled"><span class="page-link">&hellip;</span></li>
        {% endif %}
        {% endfor %}

        <li class="page-item {% if not pagination.has_next %}disabled{% endif %}">
          <a class="page-link"
            href="{{ url_for('blog_list', page=pagination.next_num) if pagination.has_next else '#' }}">Próxima
            &raquo;</a>
        </li>
      </ul>
    </nav>
    {% endif %}

  </div>
</section>
{% endblock %}